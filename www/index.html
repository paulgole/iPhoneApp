<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<title>IC Advanced Basics - LOGIC Question</title>

	<style>
		body {
			margin: 0px;
			padding: 0px;
			background-color: #fff;
			overflow: hidden;
		}

		#myCanvas {
			position: absolute;
			left: 0px;
			top: 0px;
			background-color: #fff;
		}
	</style>

	<script src="js/createjs-2015.11.26.min.js"></script>
	<script src="js/zim-2.6.1.js"></script>


	<script>
		window.addEventListener("load", function() {

			var stageW;
			var stageH;
			var ready = false;
			var resize;
			var orientation;

			makeCanvas();


			var stage = new createjs.Stage("myCanvas");
			//stage.enableMouseOver(10); // leave out if mobile
			createjs.Touch.enable(stage, true);

			var queue = new createjs.LoadQueue(false);

			queue.loadManifest([{
				id: 'title',
				src: 'img/title.png'
			}]);

			queue.on('complete', function() {
				// var title = new createjs.Bitmap(queue.getResult('title'));
				// console.log(title.getBounds().width);
				// var titleSize = title.getBounds(title.scaleX = title.scaleY = stageW / stageH * 3).width;
				// stage.addChild(title);
				// title.x = (stageW / 2) - (titleSize / 2);
				// title.y = stageH / 15;
				// title.alpha = 0.8;
				init();
			});

			sizeStage();

			function init() {
				var row = 7;
				var radius = stageW / 25;
				var size = radius * 2;
				var spacing = stageH * .03;
				var counter = 0;

				var cols = 6;
				var rows = 6;

				var total = cols * rows;

				circles = new createjs.Container();
				stage.addChild(circles);
				circles.y = stageH / 4;
				circles.x = stageW / 6;

				createCircles();

				function createCircles() {

					for (var i = 0; i < total; i++) {
						var colors = ['#FFF361', '#4A90E2', '#CA8EFF', '#FF596D', '#B8E986', '#FFAC8D'];
						var randomNum = Math.floor(Math.random() * colors.length);
						circle = new createjs.Shape();
						circle.graphics.f(colors[randomNum]).dc(0, 0, radius);
						circles.addChild(circle);
						circle.x = (size + spacing) * (i % cols);
						circle.y = (size + spacing) * Math.floor(i / cols);
						stage.update();
					}
				}

				/////////////  TRAY  /////////////////
				var tray = new createjs.Container();

				tray.height = stageH*.15;

				stage.addChild(tray);

				var trayBacking = new createjs.Shape();

				trayBacking.graphics.dr(3*stageW/4,0,stageW,tray.height);

				tray.addChild(trayBacking);

				var score = new createjs.Text("Score: ", size*.6 + "px arial", "#e2e2e2");

				var answer = new createjs.Text( counter, size*.8 + "px arial", "#878787");

				answer.textAlign = "center";
				answer.textBaseline = "middle";

				score.textAlign = "center";
				score.textBaseline = "middle";

				tray.addChild(answer);

				tray.addChild(score);

				answer.x = 7*stageW/8;
				answer.y = tray.height/2;

				score.x = answer.x - stageW/10;
				score.y = tray.height/2;

				var time = new createjs.Text("Time: ", size*.6 + "px arial", "#e2e2e2");

				var timer = new createjs.Text(counter, size*.8 + "px arial", "#878787");

				timer.textAlign = "center";
				timer.textBaseline = "middle";

				time.textAlign = "center";
				time.textBaseline = "middle";

				tray.addChild(time);

				tray.addChild(timer);

				timer.x = stageW/4 + 50;
				timer.y = tray.height/2;

				time.x = timer.x - stageW/10;
				time.y = tray.height/2;


				tray.y = 1;

				circles.on('mousedown', function(e) {
					var duration = 250;
					var thisCircle = e.target;
					console.log(thisCircle);
					var ticker = createjs.Ticker.on("tick", stage);
					createjs.Tween.get(thisCircle).to({
						scaleX: 1.5,
						scaleY: 1.5,
						alpha: 0
					}, duration, createjs.Ease.sineInOut);
					setTimeout(function() {
						circles.removeChild(thisCircle);
					}, duration);
					counter++;
					answer.text = counter;
					stage.update();
				});

				//this can be placed into your module- or should be
				function shuffle(array) {
					if (array == null) return;
					var i = array.length,
						j, temp;
					if (i == 0) return array;
					while (--i) {
						j = Math.floor(Math.random() * (i + 1));
						temp = array[i];
						array[i] = array[j];
						array[j] = temp;
					}
					return array;
				}

				stage.update();
			}

			resize = function() {
				// here is where we put code to resize

				stage.update();
			}

			stage.update();
			ready = true;

			// ----------------------------------------------
			// start template footer
			function makeCanvas() {
				// make a canvas tag and apply attributes for id, width and height
				var canvas = document.createElement("canvas");
				canvas.setAttribute("id", "myCanvas");

				// get maximum size for canvas
				// note: iOS6 does not work from loading icon unless keep canvas within device size
				// thank you apple for this and many other days of hell
				largest = Math.max(window.innerWidth, screen.width, window.innerHeight, screen.height);
				if (!/ip(hone|od|ad)/i.test(navigator.userAgent)) largest *= 3; // handle up to three monitors
				canvas.setAttribute("width", largest);
				canvas.setAttribute("height", largest);

				// add our canvas tag
				document.body.appendChild(canvas);

				// stop the canvas from moving when certain keys are pressed (pgdwn, pgup, arrows, home, end)
				// and stop scrollwheel from moving page
				var a = function(e) {
					if (!e) e = event;
					if (e.keyCode && (e.keyCode >= 32 && e.keyCode <= 40)) e.preventDefault();
				}
				var b = function(e) {
					if (!e) e = event;
					e.preventDefault();
				}
				var c = b;
				window.addEventListener("keydown", a);
				window.addEventListener("mousewheel", b);
				window.addEventListener("DOMMouseScroll", c);
				window.addEventListener('resize', function() {
					sizeStage();
					if (/android|nexus/i.test(navigator.userAgent)) {
						setTimeout(function() {
							sizeStage();
						}, 500); // to catch delayed screen sizes
					}
				});
			}

			function sizeStage() {
				// earlier than IE9 does not have innerWidth
				// inner is better on mobile when zoomed so can't always use client
				// ternary operator
				stageW = isNaN(window.innerWidth) ? window.clientWidth : window.innerWidth;
				stageH = isNaN(window.innerHeight) ? window.clientHeight : window.innerHeight;

				// if wider than high then we have horizontal (or landscape)
				orientation = (stageW > stageH) ? "horizontal" : "vertical";

				if (stage) stage.setBounds(0, 0, stageW, stageH);
				if (ready) resize();
			}
		});
	</script>
</head>

<body>

</body>

</html>
